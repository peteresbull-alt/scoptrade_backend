{% extends "dashboard/base.html" %}
{% block title %}Change User Password - ScopTrade Admin{% endblock %}
{% block page_title %}Change User Password{% endblock %}

{% block content %}
<div class="max-w-lg mx-auto">
    <div class="bg-white rounded-xl border border-gray-200/60 p-6">
        <div class="mb-6">
            <div class="w-12 h-12 bg-indigo-100 rounded-full flex items-center justify-center mb-4">
                <i class="fas fa-key text-xl text-indigo-600"></i>
            </div>
            <h3 class="text-lg font-semibold text-gray-800">Change User Password</h3>
            <p class="text-sm text-gray-500 mt-1">Select a user and set a new password for testing purposes.</p>
        </div>

        <form method="post">
            {% csrf_token %}
            <div class="space-y-4">
                <!-- User Select -->
                <div>
                    <label for="user_id" class="block text-sm font-medium text-gray-700 mb-1.5">Select User</label>
                    <select
                        id="user_id"
                        name="user_id"
                        onchange="if(this.value) window.location.href='?user_id='+this.value"
                        class="w-full px-4 py-2.5 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500"
                    >
                        <option value="">-- Select a user --</option>
                        {% for user in users %}
                        <option value="{{ user.id }}" {% if selected_user and selected_user.id == user.id %}selected{% endif %}>
                            {{ user.email }}{% if user.first_name %} ({{ user.first_name }} {{ user.last_name }}){% endif %}
                        </option>
                        {% endfor %}
                    </select>
                </div>

                {% if selected_user %}
                <!-- Selected User Info -->
                <div class="bg-gray-50 rounded-lg p-4">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center text-indigo-600 font-bold text-sm">
                            {{ selected_user.email|first|upper }}
                        </div>
                        <div>
                            <p class="text-sm font-medium text-gray-800">{{ selected_user.first_name }} {{ selected_user.last_name }}</p>
                            <p class="text-xs text-gray-400">{{ selected_user.email }}</p>
                        </div>
                    </div>
                </div>

                <!-- New Password -->
                <div>
                    <label for="new_password" class="block text-sm font-medium text-gray-700 mb-1.5">New Password</label>
                    <input
                        type="password"
                        id="new_password"
                        name="new_password"
                        placeholder="Enter new password"
                        required
                        minlength="6"
                        class="w-full px-4 py-2.5 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500"
                    >
                </div>

                <!-- Confirm Password -->
                <div>
                    <label for="confirm_password" class="block text-sm font-medium text-gray-700 mb-1.5">Confirm Password</label>
                    <input
                        type="password"
                        id="confirm_password"
                        name="confirm_password"
                        placeholder="Confirm new password"
                        required
                        minlength="6"
                        class="w-full px-4 py-2.5 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500"
                    >
                </div>

                <!-- Hidden user_id for POST -->
                <input type="hidden" name="user_id" value="{{ selected_user.id }}">

                <!-- Submit -->
                <button
                    type="submit"
                    class="w-full py-2.5 bg-indigo-600 text-white rounded-lg text-sm font-medium hover:bg-indigo-500 transition"
                >
                    <i class="fas fa-save mr-1"></i> Change Password
                </button>
                {% endif %}
            </div>
        </form>
    </div>
</div>
{% endblock %}
