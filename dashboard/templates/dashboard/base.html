{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}ScopTrade Admin{% endblock %}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        ::-webkit-scrollbar{width:6px}
        ::-webkit-scrollbar-track{background:#1e293b}
        ::-webkit-scrollbar-thumb{background:#475569;border-radius:3px}
        ::-webkit-scrollbar-thumb:hover{background:#64748b}
        .sidebar{transform:translateX(-100%);transition:transform .3s ease}
        .sidebar.show{transform:translateX(0)}
        @media(min-width:1024px){.sidebar{transform:translateX(0)}}
    </style>
</head>
<body class="bg-gray-100 min-h-screen">

<!-- Overlay -->
<div id="overlay" class="fixed inset-0 bg-black/50 z-30 hidden lg:hidden" onclick="toggleSidebar()"></div>

<!-- Sidebar -->
<aside id="sidebar" class="sidebar fixed top-0 left-0 bottom-0 w-64 bg-slate-900 text-white z-40 flex flex-col overflow-y-auto">
    <!-- Logo -->
    <div class="px-5 py-5 border-b border-slate-700/50">
        <a href="{% url 'dashboard:dashboard' %}" class="flex items-center gap-2">
            <div class="w-9 h-9 bg-indigo-500 rounded-lg flex items-center justify-center">
                <i class="fas fa-chart-line text-white text-sm"></i>
            </div>
            <div>
                <h1 class="text-base font-bold tracking-tight">ScopTrade</h1>
                <p class="text-[10px] text-slate-400 -mt-0.5">Admin Panel</p>
            </div>
        </a>
    </div>

    <nav class="flex-1 px-3 py-4 space-y-1">
        <!-- Main -->
        <p class="px-3 text-[10px] font-semibold text-slate-500 uppercase tracking-wider mb-2">Main</p>
        <a href="{% url 'dashboard:dashboard' %}" class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm {% if request.resolver_match.url_name == 'dashboard' %}bg-indigo-600 text-white{% else %}text-slate-300 hover:bg-slate-800 hover:text-white{% endif %} transition">
            <i class="fas fa-home w-5 text-center"></i>Dashboard
        </a>

        <!-- Users -->
        <p class="px-3 pt-4 text-[10px] font-semibold text-slate-500 uppercase tracking-wider mb-2">Users</p>
        <a href="{% url 'dashboard:investors_list' %}" class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm {% if 'investor' in request.resolver_match.url_name %}bg-indigo-600 text-white{% else %}text-slate-300 hover:bg-slate-800 hover:text-white{% endif %} transition">
            <i class="fas fa-wallet w-5 text-center"></i>Investors
        </a>
        <a href="{% url 'dashboard:users_list' %}" class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm {% if request.resolver_match.url_name == 'users_list' or request.resolver_match.url_name == 'user_detail' %}bg-indigo-600 text-white{% else %}text-slate-300 hover:bg-slate-800 hover:text-white{% endif %} transition">
            <i class="fas fa-users w-5 text-center"></i>Manage Users
        </a>
        <a href="{% url 'dashboard:kyc_requests' %}" class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm {% if 'kyc' in request.resolver_match.url_name %}bg-indigo-600 text-white{% else %}text-slate-300 hover:bg-slate-800 hover:text-white{% endif %} transition">
            <i class="fas fa-id-card w-5 text-center"></i>KYC Requests
        </a>

        <!-- Requests -->
        <p class="px-3 pt-4 text-[10px] font-semibold text-slate-500 uppercase tracking-wider mb-2">Requests</p>
        <a href="{% url 'dashboard:deposits' %}" class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm {% if 'deposit' in request.resolver_match.url_name %}bg-indigo-600 text-white{% else %}text-slate-300 hover:bg-slate-800 hover:text-white{% endif %} transition">
            <i class="fas fa-arrow-down w-5 text-center"></i>Deposits
        </a>
        <a href="{% url 'dashboard:withdrawals' %}" class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm {% if 'withdrawal' in request.resolver_match.url_name %}bg-indigo-600 text-white{% else %}text-slate-300 hover:bg-slate-800 hover:text-white{% endif %} transition">
            <i class="fas fa-arrow-up w-5 text-center"></i>Withdrawals
        </a>
        <a href="{% url 'dashboard:transactions' %}" class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm {% if request.resolver_match.url_name == 'transactions' %}bg-indigo-600 text-white{% else %}text-slate-300 hover:bg-slate-800 hover:text-white{% endif %} transition">
            <i class="fas fa-exchange-alt w-5 text-center"></i>All Transactions
        </a>

        <!-- Trading -->
        <p class="px-3 pt-4 text-[10px] font-semibold text-slate-500 uppercase tracking-wider mb-2">Trading</p>
        <a href="{% url 'dashboard:add_trade' %}" class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm {% if request.resolver_match.url_name == 'add_trade' %}bg-indigo-600 text-white{% else %}text-slate-300 hover:bg-slate-800 hover:text-white{% endif %} transition">
            <i class="fas fa-chart-bar w-5 text-center"></i>Add Trade
        </a>
        <a href="{% url 'dashboard:add_earnings' %}" class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm {% if request.resolver_match.url_name == 'add_earnings' %}bg-indigo-600 text-white{% else %}text-slate-300 hover:bg-slate-800 hover:text-white{% endif %} transition">
            <i class="fas fa-dollar-sign w-5 text-center"></i>Add Earnings
        </a>

        <!-- Copy Trading -->
        <p class="px-3 pt-4 text-[10px] font-semibold text-slate-500 uppercase tracking-wider mb-2">Copy Trading</p>
        <a href="{% url 'dashboard:copy_trades_list' %}" class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm {% if request.resolver_match.url_name == 'copy_trades_list' or request.resolver_match.url_name == 'copy_trade_detail' %}bg-indigo-600 text-white{% else %}text-slate-300 hover:bg-slate-800 hover:text-white{% endif %} transition">
            <i class="fas fa-copy w-5 text-center"></i>Copy Trades
        </a>
        <a href="{% url 'dashboard:add_copy_trade' %}" class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm {% if request.resolver_match.url_name == 'add_copy_trade' %}bg-indigo-600 text-white{% else %}text-slate-300 hover:bg-slate-800 hover:text-white{% endif %} transition">
            <i class="fas fa-plus-circle w-5 text-center"></i>Add Copy Trade
        </a>

        <!-- Settings -->
        <p class="px-3 pt-4 text-[10px] font-semibold text-slate-500 uppercase tracking-wider mb-2">Settings</p>
        <a href="{% url 'dashboard:wallets_list' %}" class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm {% if request.resolver_match.url_name == 'wallets_list' or request.resolver_match.url_name == 'add_wallet' or request.resolver_match.url_name == 'edit_wallet' or request.resolver_match.url_name == 'delete_wallet' %}bg-indigo-600 text-white{% else %}text-slate-300 hover:bg-slate-800 hover:text-white{% endif %} transition">
            <i class="fas fa-coins w-5 text-center"></i>Admin Wallets
        </a>
        <a href="{% url 'dashboard:wallet_connections_list' %}" class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm {% if 'wallet_connection' in request.resolver_match.url_name %}bg-indigo-600 text-white{% else %}text-slate-300 hover:bg-slate-800 hover:text-white{% endif %} transition">
            <i class="fas fa-link w-5 text-center"></i>Wallet Connections
        </a>
        <a href="{% url 'dashboard:change_user_password' %}" class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm {% if request.resolver_match.url_name == 'change_user_password' %}bg-indigo-600 text-white{% else %}text-slate-300 hover:bg-slate-800 hover:text-white{% endif %} transition">
            <i class="fas fa-key w-5 text-center"></i>Change User Password
        </a>

        <!-- Trader Management -->
        <p class="px-3 pt-4 text-[10px] font-semibold text-slate-500 uppercase tracking-wider mb-2">Trader Mgmt</p>
        <a href="{% url 'dashboard:traders_list' %}" class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm {% if request.resolver_match.url_name == 'traders_list' or request.resolver_match.url_name == 'trader_detail' %}bg-indigo-600 text-white{% else %}text-slate-300 hover:bg-slate-800 hover:text-white{% endif %} transition">
            <i class="fas fa-user-tie w-5 text-center"></i>Pro Traders
        </a>
        <a href="{% url 'dashboard:add_trader' %}" class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm {% if request.resolver_match.url_name == 'add_trader' %}bg-indigo-600 text-white{% else %}text-slate-300 hover:bg-slate-800 hover:text-white{% endif %} transition">
            <i class="fas fa-user-plus w-5 text-center"></i>Add Trader
        </a>
    </nav>

    <!-- Logout -->
    <div class="px-3 pb-4 border-t border-slate-700/50 pt-3">
        <a href="{% url 'dashboard:logout' %}" class="flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm text-red-400 hover:bg-red-500/10 hover:text-red-300 transition">
            <i class="fas fa-sign-out-alt w-5 text-center"></i>Logout
        </a>
    </div>
</aside>

<!-- Main Content -->
<div class="lg:ml-64 min-h-screen">
    <!-- Top Bar -->
    <header class="sticky top-0 z-20 bg-white/80 backdrop-blur-xl border-b border-gray-200/60">
        <div class="flex items-center justify-between px-4 sm:px-6 py-3">
            <div class="flex items-center gap-3">
                <button onclick="toggleSidebar()" class="lg:hidden p-2 -ml-2 rounded-lg text-gray-500 hover:bg-gray-100">
                    <i class="fas fa-bars text-lg"></i>
                </button>
                <h2 class="text-lg font-semibold text-gray-800">{% block page_title %}Dashboard{% endblock %}</h2>
            </div>
            <div class="flex items-center gap-3">
                <span class="hidden sm:block text-sm text-gray-500">{{ request.user.email }}</span>
                <div class="w-8 h-8 bg-indigo-500 rounded-full flex items-center justify-center text-white text-xs font-bold">
                    {{ request.user.email|first|upper }}
                </div>
            </div>
        </div>
    </header>

    <!-- Messages -->
    {% if messages %}
    <div class="px-4 sm:px-6 pt-4 space-y-2">
        {% for message in messages %}
        <div class="flex items-center gap-3 px-4 py-3 rounded-lg text-sm {% if message.tags == 'success' %}bg-emerald-50 text-emerald-800 border border-emerald-200{% elif message.tags == 'error' %}bg-red-50 text-red-800 border border-red-200{% elif message.tags == 'warning' %}bg-amber-50 text-amber-800 border border-amber-200{% else %}bg-blue-50 text-blue-800 border border-blue-200{% endif %}">
            <i class="fas {% if message.tags == 'success' %}fa-check-circle{% elif message.tags == 'error' %}fa-exclamation-circle{% elif message.tags == 'warning' %}fa-exclamation-triangle{% else %}fa-info-circle{% endif %}"></i>
            <span>{{ message }}</span>
            <button onclick="this.parentElement.remove()" class="ml-auto text-current opacity-50 hover:opacity-100"><i class="fas fa-times"></i></button>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <!-- Page Content -->
    <main class="p-4 sm:p-6">
        {% block content %}{% endblock %}
    </main>
</div>

<script>
function toggleSidebar(){
    document.getElementById('sidebar').classList.toggle('show');
    document.getElementById('overlay').classList.toggle('hidden');
}
document.addEventListener('DOMContentLoaded',function(){
    document.querySelectorAll('#sidebar a').forEach(function(link){
        link.addEventListener('click',function(){
            if(window.innerWidth<1024){toggleSidebar()}
        });
    });
});
</script>
{% block extra_js %}{% endblock %}
</body>
</html>
