{% extends "dashboard/base.html" %}
{% block title %}Investors - ScopTrade Admin{% endblock %}
{% block page_title %}Investors{% endblock %}

{% block content %}
<div class="bg-white rounded-xl border border-gray-200/60 p-4 mb-6">
    <form method="get" class="flex flex-col sm:flex-row gap-3">
        <div class="relative flex-1">
            <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm"></i>
            <input type="text" name="search" value="{{ search_query }}" placeholder="Search by email, name, account ID…"
                class="w-full pl-10 pr-4 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
        </div>
        <button type="submit" class="px-5 py-2.5 bg-indigo-600 text-white rounded-lg text-sm font-medium hover:bg-indigo-500 transition">Search</button>
    </form>
</div>

<div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6">
    <div class="bg-white rounded-xl border border-gray-200/60 p-4 text-center">
        <p class="text-2xl font-bold text-gray-800">{{ total_investors }}</p>
        <p class="text-xs text-gray-500">Total Investors</p>
    </div>
</div>

<div class="bg-white rounded-xl border border-gray-200/60 overflow-hidden">
    <div class="overflow-x-auto">
        <table class="w-full text-sm min-w-[800px]">
            <thead><tr class="bg-gray-50 text-left text-xs text-gray-500 uppercase">
                <th class="px-5 py-3">Investor</th>
                <th class="px-5 py-3">Account ID</th>
                <th class="px-5 py-3">Total Deposits</th>
                <th class="px-5 py-3">Completed</th>
                <th class="px-5 py-3">Pending</th>
                <th class="px-5 py-3">Total Amount</th>
                <th class="px-5 py-3">Actions</th>
            </tr></thead>
            <tbody class="divide-y divide-gray-100">
            {% for inv in investors %}
            <tr class="hover:bg-gray-50">
                <td class="px-5 py-3">
                    <div class="flex items-center gap-3">
                        <div class="w-9 h-9 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 text-sm font-bold">{{ inv.user.email|first|upper }}</div>
                        <div>
                            <p class="font-medium text-gray-800">{{ inv.user.first_name }} {{ inv.user.last_name }}</p>
                            <p class="text-xs text-gray-400">{{ inv.user.email }}</p>
                        </div>
                    </div>
                </td>
                <td class="px-5 py-3 text-gray-500">{{ inv.user.account_id|default:"—" }}</td>
                <td class="px-5 py-3 font-medium">{{ inv.total_deposits }}</td>
                <td class="px-5 py-3"><span class="px-2 py-0.5 rounded-full text-xs bg-emerald-50 text-emerald-700">{{ inv.completed_deposits }}</span></td>
                <td class="px-5 py-3"><span class="px-2 py-0.5 rounded-full text-xs bg-yellow-50 text-yellow-700">{{ inv.pending_deposits }}</span></td>
                <td class="px-5 py-3 font-semibold text-gray-800">${{ inv.total_amount|floatformat:2 }}</td>
                <td class="px-5 py-3">
                    <a href="{% url 'dashboard:investor_detail' inv.user.id %}" class="px-2.5 py-1 bg-indigo-50 text-indigo-600 rounded text-xs font-medium hover:bg-indigo-100 transition">View</a>
                </td>
            </tr>
            {% empty %}
            <tr><td colspan="7" class="px-5 py-12 text-center text-gray-400">No investors found</td></tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% include "dashboard/pagination.html" %}
{% endblock %}
