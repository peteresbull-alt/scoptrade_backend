{% extends "dashboard/base.html" %}
{% block title %}Deposits - ScopTrade Admin{% endblock %}
{% block page_title %}Deposit Requests{% endblock %}

{% block content %}
<div class="flex gap-2 mb-6 flex-wrap">
    <a href="?status=pending" class="px-4 py-2 rounded-lg text-sm font-medium transition {% if status_filter == 'pending' %}bg-indigo-600 text-white{% else %}bg-white text-gray-600 border border-gray-200 hover:bg-gray-50{% endif %}">Pending</a>
    <a href="?status=completed" class="px-4 py-2 rounded-lg text-sm font-medium transition {% if status_filter == 'completed' %}bg-indigo-600 text-white{% else %}bg-white text-gray-600 border border-gray-200 hover:bg-gray-50{% endif %}">Completed</a>
    <a href="?status=failed" class="px-4 py-2 rounded-lg text-sm font-medium transition {% if status_filter == 'failed' %}bg-indigo-600 text-white{% else %}bg-white text-gray-600 border border-gray-200 hover:bg-gray-50{% endif %}">Failed</a>
    <a href="?status=all" class="px-4 py-2 rounded-lg text-sm font-medium transition {% if status_filter == 'all' %}bg-indigo-600 text-white{% else %}bg-white text-gray-600 border border-gray-200 hover:bg-gray-50{% endif %}">All</a>
</div>

<div class="bg-white rounded-xl border border-gray-200/60 overflow-hidden">
    <div class="overflow-x-auto">
        <table class="w-full text-sm min-w-[800px]">
            <thead><tr class="bg-gray-50 text-left text-xs text-gray-500 uppercase">
                <th class="px-5 py-3">User</th><th class="px-5 py-3">Amount</th><th class="px-5 py-3">Currency</th><th class="px-5 py-3">Reference</th><th class="px-5 py-3">Status</th><th class="px-5 py-3">Date</th><th class="px-5 py-3">Actions</th>
            </tr></thead>
            <tbody class="divide-y divide-gray-100">
            {% for d in deposits %}
            <tr class="hover:bg-gray-50">
                <td class="px-5 py-3">
                    <div class="flex items-center gap-2">
                        <div class="w-7 h-7 bg-indigo-100 rounded-full flex items-center justify-center text-indigo-600 text-[10px] font-bold">{{ d.user.email|first|upper }}</div>
                        <span class="truncate max-w-[160px] text-xs">{{ d.user.email }}</span>
                    </div>
                </td>
                <td class="px-5 py-3 font-semibold">${{ d.amount|floatformat:2 }}</td>
                <td class="px-5 py-3 text-gray-500">{{ d.currency }}</td>
                <td class="px-5 py-3 font-mono text-xs text-gray-500">{{ d.reference|truncatechars:14 }}</td>
                <td class="px-5 py-3"><span class="px-2 py-0.5 rounded-full text-xs font-medium {% if d.status == 'completed' %}bg-emerald-50 text-emerald-700{% elif d.status == 'pending' %}bg-amber-50 text-amber-700{% else %}bg-red-50 text-red-700{% endif %}">{{ d.status|title }}</span></td>
                <td class="px-5 py-3 text-xs text-gray-400">{{ d.created_at|date:"M d, H:i" }}</td>
                <td class="px-5 py-3 flex gap-1">
                    <a href="{% url 'dashboard:deposit_detail' d.id %}" class="px-2.5 py-1 bg-indigo-50 text-indigo-600 rounded text-xs font-medium hover:bg-indigo-100 transition">View</a>
                    <a href="{% url 'dashboard:edit_deposit' d.id %}" class="px-2.5 py-1 bg-gray-50 text-gray-600 rounded text-xs font-medium hover:bg-gray-100 transition">Edit</a>
                </td>
            </tr>
            {% empty %}
            <tr><td colspan="7" class="px-5 py-12 text-center text-gray-400">No deposits found</td></tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% include "dashboard/pagination.html" %}
{% endblock %}
